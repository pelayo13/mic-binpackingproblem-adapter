openapi: 3.0.3
info:
  title: bpp-adapter API REST
  version: 1.0.0
  description: >
    ## Bin packing problem adapter API REST
servers:
  - url: http://localhost:8081
    description: Localhost
tags:
  - name: bppInstance
    description: Endpoint for bpp instance.
  - name: bppSolution
    description: Endpoint for bpp solution.
paths:
  /api/v1/bpp-instances:
    post:
      tags:
        - BppInstance
      summary: CreateByFiles
      description: |-
        Create a bpp instance using the file provided, one bpp instance per file; that created instance is not persisted
      operationId: CreateByFiles
      parameters: [
        {
          "name": 'Accept-Language',
          "in": "header",
          "description": "Indicates the natural language and locale that the client prefers",
          "schema": {
            "type": "string"
          }
        }
      ]
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - files
              properties:
                files:
                  type: array
                  items:
                    type: string
                    format: binary
      responses:
        '200':
          description: 'Bin packing problem instances'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateByFilesResponse'
        '400':
          description: Bad request.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
        '500':
          description: Unexpected error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
        default:
          description: Unexpected error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
  /api/v1/bpp-solutions:
    post:
      tags:
        - BppSolution
      summary: CreateByBppSolvableInstances
      description: |-
        Solve each instance and return the solution for it; that created solution is not persisted
      operationId: CreateByBppSolvableInstances
      parameters: [
        {
          "name": 'Accept-Language',
          "in": "header",
          "description": "Indicates the natural language and locale that the client prefers",
          "schema": {
            "type": "string"
          }
        }
      ]
      requestBody:
        description: Bpp solvable instance, which contains the solving and local seach algorithms that will be applied to each instance
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateByBppSolvableInstancesRequest'
        required: true
      responses:
        '200':
          description: 'Bin packing problem solutions'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateByBppSolvableInstancesResponse'
        '400':
          description: Bad request.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
        '500':
          description: Unexpected error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
        default:
          description: Unexpected error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
  /api/v1/bpp-detailed-solutions:
    post:
      tags:
        - BppSolution
      summary: CreateBppDetailedSolutionByBppSolvableInstances
      description: |-
        Solve each instance and return the solution for it; that created solution is not persisted
      operationId: CreateBppDetailedSolutionByBppSolvableInstances
      parameters: [
        {
          "name": 'Accept-Language',
          "in": "header",
          "description": "Indicates the natural language and locale that the client prefers",
          "schema": {
            "type": "string"
          }
        }
      ]
      requestBody:
        description: Bpp solvable instance, which contains the solving and local seach algorithms that will be applied to each instance
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateBppDetailedSolutionsByBppSolvableInstancesRequest'
        required: true
      responses:
        '200':
          description: 'Bin packing problem solutions'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateBppDetailedSolutionsByBppSolvableInstancesResponse'
        '400':
          description: Bad request.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
        '500':
          description: Unexpected error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
        default:
          description: Unexpected error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
  /api/v1/bpp-test-instance-results:
    post:
      tags:
        - BppTests
      summary: CreateByBppTestInstance
      description: |-
        Obtain the test results of the test instance that allow algorithm comparisons; that created test results are not persisted
      operationId: CreateByBppTestInstance
      parameters: [
        {
          "name": 'Accept-Language',
          "in": "header",
          "description": "Indicates the natural language and locale that the client prefers",
          "schema": {
            "type": "string"
          }
        }
      ]
      requestBody:
        description: Bpp test instance, which contains the the characteristics of the tests
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateByBppTestInstancesRequest'
        required: true
      responses:
        '200':
          description: 'Bin packing problem test results'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateByBppTestInstancesResponse'
        '400':
          description: Bad request.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
        '500':
          description: Unexpected error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
        default:
          description: Unexpected error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
  /api/v1/bpp-test-results:
    post:
      tags:
        - BppTests
      summary: CreateByBppInstances
      description: |-
        Obtain the test results of the test instance that allow algorithm comparisons; that created test results are not persisted
      operationId: CreateByBppInstances
      parameters: [
        {
          "name": 'Accept-Language',
          "in": "header",
          "description": "Indicates the natural language and locale that the client prefers",
          "schema": {
            "type": "string"
          }
        }
      ]
      requestBody:
        description: Bpp test instance, which contains the the characteristics of the tests
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateByBppInstancesRequest'
        required: true
      responses:
        '200':
          description: 'Bin packing problem test results'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateByBppInstancesResponse'
        '400':
          description: Bad request.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
        '500':
          description: Unexpected error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
        default:
          description: Unexpected error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RestErrorResponse'
components:
  schemas:
    CreateByBppInstancesRequest:
      description: 'Request that contains the data needed to know the instances that have to be performed to be tested'
      type: object
      required:
        - instances
      properties:
        instances:
          type: array
          items:
            $ref: '#/components/schemas/BppSolvableInstanceDto'
    CreateByBppTestInstancesRequest:
      description: 'Request that contains the data needed to know the instances that have to be performed to be tested'
      type: object
      required:
        - testInstance
      properties:
        instance:
          $ref: '#/components/schemas/BppTestInstanceDto'
    CreateByBppSolvableInstancesRequest:
      description: 'Request that contains the instances to be solved'
      type: object
      required:
        - instances
      properties:
        instances:
          type: array
          items:
            $ref: '#/components/schemas/BppSolvableInstanceDto'
    CreateBppDetailedSolutionsByBppSolvableInstancesRequest:
      description: 'Request that contains the instances to be solved'
      type: object
      required:
        - instances
      properties:
        instances:
          type: array
          items:
            $ref: '#/components/schemas/BppSolvableInstanceDto'
    CreateByFilesResponse:
      description: 'Response that contains the instances created using the files and the errors for the instances that could not be created'
      type: object
      required:
        - instances
        - filesWithErrors
      properties:
        instances:
          type: array
          items:
            $ref: '#/components/schemas/BppInitialInstanceDto'
        filesWithErrors:
          type: array
          items:
            $ref: '#/components/schemas/CreateByFileErrorResponse'
    CreateByFileErrorResponse:
      description: 'Response error'
      allOf:
        - $ref: '#/components/schemas/RestErrorResponse'
        - type: object
          required:
            - filename
          properties:
            filename:
              type: string
    CreateByBppSolvableInstancesResponse:
      description: 'Response that contains the solutions of each instance and the errors for the instances that could not be solved'
      type: object
      required:
        - solutions
        - instancesWithErrors
      properties:
        solutions:
          type: array
          items:
            $ref: '#/components/schemas/BppSolutionDto'
        instancesWithErrors:
          type: array
          items:
            $ref: '#/components/schemas/CreateByBppSolvableInstancesErrorResponse'
    CreateByBppSolvableInstancesErrorResponse:
      description: 'Errors found for each instance that failed'
      allOf:
        - $ref: '#/components/schemas/RestErrorResponse'
        - type: object
          required:
            - instancePositionInRequest
          properties:
            instancePositionInRequest:
              type: integer
              minimum: 0
    CreateBppDetailedSolutionsByBppSolvableInstancesResponse:
      description: 'Response that contains the solutions of each instance and the errors for the instances that could not be solved'
      type: object
      required:
        - detailedSolutions
        - instancesWithErrors
      properties:
        detailedSolutions:
          type: array
          items:
            $ref: '#/components/schemas/BppDetailedSolutionDto'
        instancesWithErrors:
          type: array
          items:
            $ref: '#/components/schemas/CreateBppDetailedSolutionsByBppSolvableInstancesErrorResponse'
    CreateBppDetailedSolutionsByBppSolvableInstancesErrorResponse:
      description: 'Errors found for each instance that failed'
      allOf:
        - $ref: '#/components/schemas/RestErrorResponse'
        - type: object
          required:
            - instancePositionInRequest
          properties:
            instancePositionInRequest:
              type: integer
              minimum: 0
    CreateByBppTestInstancesResponse:
      description: 'Response that contains the test results'
      type: object
      required:
        - testInstanceResults
        - testInstancesWithErrors
      properties:
        testInstanceResults:
          $ref: '#/components/schemas/BppTestInstanceResultsDto'
        testInstancesWithErrors:
          type: array
          items:
            $ref: '#/components/schemas/CreateByBppTestInstancesErrorResponse'
    CreateByBppTestInstancesErrorResponse:
      description: 'Errors found for each algorithm applied on the test case instance'
      allOf:
        - $ref: '#/components/schemas/RestErrorResponse'
        - type: object
          required:
            - algorithm
          properties:
            algorithm:
              $ref: '#/components/schemas/BppAlgorithmDto'
    CreateByBppInstancesResponse:
      description: 'Response that contains the test results'
      type: object
      required:
        - testResults
        - instancesWithErrors
      properties:
        testResults:
          type: array
          items:
            $ref: '#/components/schemas/BppTestResultsDto'
        instancesWithErrors:
          type: array
          items:
            $ref: '#/components/schemas/CreateByBppInstancesErrorResponse'
    CreateByBppInstancesErrorResponse:
      description: 'Errors found for each instance that failed'
      allOf:
        - $ref: '#/components/schemas/RestErrorResponse'
        - type: object
          required:
            - instancePositionInRequest
          properties:
            instancePositionInRequest:
              type: integer
              minimum: 0
    RestErrorResponse:
      description: 'Default error'
      type: object
      required:
        - code
        - title
        - detail
      properties:
        code:
          type: integer
        title:
          type: string
        detail:
          type: string
    BppBinDto:
      description: 'Bin where the items have to be stored'
      type: object
      required:
        - items
      properties:
        items:
          description: 'items that the bin has stored inside'
          type: array
          items:
            $ref: '#/components/schemas/BppStoredItemDto'
    BppItemDto:
      description: 'Item that has to be stored in a bin filling its capacity'
      type: object
      required:
        - size
        - dueDate
      properties:
        size:
          type: integer
          minimum: 0
        dueDate:
          description: 'Moment in which the item has to be stored in one of the bins, otherwise, it produces tardiness'
          type: integer
          minimum: 0
    BppInitialInstanceDto:
      description: 'Instance that contains the items to be stored in the bins of the indicated size'
      type: object
      required:
        - items
        - binsCapacity
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/BppItemDto'
        binsCapacity:
          type: integer
          minimum: 0
    BppSolutionDto:
      description: 'Solution that contains the bins with all the items placed in each of them'
      type: object
      required:
        - bins
      properties:
        bins:
          type: array
          items:
            $ref: '#/components/schemas/BppBinDto'
    BppDetailedSolutionDto:
      description: 'Solution that contains the bins with all the items placed in each of them'
      type: object
      required:
        - recordInstances
      properties:
        recordInstances:
          type: array
          items:
            $ref: '#/components/schemas/BppInstanceDto'
    BppStoredItemDto:
      allOf:
        - $ref: '#/components/schemas/BppItemDto'
        - type: object
          required:
            - tardiness
          properties:
            tardiness:
              type: integer
    BppInstanceDto:
      allOf:
        - $ref: '#/components/schemas/BppInitialInstanceDto'
        - type: object
          required:
            - bins
          properties:
            bins:
              type: array
              items:
                $ref: '#/components/schemas/BppBinDto'
    BppSolvableInstanceDto:
      allOf:
        - $ref: '#/components/schemas/BppInstanceDto'
        - type: object
          properties:
            algorithm:
              $ref: '#/components/schemas/BppAlgorithmDto'
    BppTestInstanceDto:
      description: 'Test instance that contains the data needed to create the instances to be tested'
      type: object
      required:
        - binsCapacity
        - minItemsSize
        - maxItemsSize
        - minItemsDueDate
        - maxItemsDueDate
        - numberItems
        - numberInstances
        - algorithms
      properties:
        binsCapacity:
          type: integer
          minimum: 0
        minItemsSize:
          type: integer
          minimum: 0
        maxItemsSize:
          type: integer
          minimum: 0
        minItemsDueDate:
          type: integer
          minimum: 0
        maxItemsDueDate:
          type: integer
          minimum: 0
        numberItems:
          type: array
          items:
            type: integer
            minimum: 0
        numberInstances:
          type: integer
          minimum: 0
        algorithms:
          type: array
          items:
            $ref: '#/components/schemas/BppAlgorithmDto'
    BppTestInstanceResultsDto:
      description: 'All the results for the test instance'
      type: object
      required:
        - testItemsResults
      properties:
        testItemsResults:
          type: array
          items:
            $ref: '#/components/schemas/BppTestItemsResultsDto'
    BppTestItemsResultsDto:
      description: 'Results for each number of items'
      type: object
      required:
        - numberItems
        - testResults
      properties:
        numberItems:
          type: integer
          minimum: 0
        testResults:
          type: array
          items:
            $ref: '#/components/schemas/BppTestResultsDto'
    BppTestResultsDto:
      description: 'Results for each algorithm applied to the number of items'
      type: object
      required:
        - algorithm
        - testCaseResults
      properties:
        averageNumberBins:
          type: number
          minimum: 0
        averageTardiness:
          type: number
          minimum: 0
        averageLateness:
          type: number
        averageMaximumLateness:
          type: number
        averageAvailableCapacity:
          type: number
          minimum: 0
        averageNumberIterations:
          type: number
          minimum: 0
        averageNumberNeighborsGenerated:
          type: number
          minimum: 0
        averageNumberEvaluatedNeighbors:
          type: number
          minimum: 0
        standardDeviationFitness:
          type: number
          minimum: 0
        averageFitness:
          type: number
          minimum: 0
        bestCaseByFitness:
          $ref: '#/components/schemas/BppTestCaseResultsDto'
        averageSeconds:
          type: number
          minimum: 0
        algorithm:
          $ref: '#/components/schemas/BppAlgorithmDto'
        testCaseResults:
          type: array
          items:
            $ref: '#/components/schemas/BppTestCaseResultsDto'
    BppTestCaseResultsDto:
      description: 'Results for each test up to the total test size'
      type: object
      properties:
        numberBins:
          type: integer
        averageTardinessStoredItems:
          type: number
        averageLatenessStoredItems:
          type: number
        maximumLateness:
          type: number
        availableCapacity:
          type: number
        numberIterations:
          type: number
        numberNeighborsGenerated:
          type: number
        numberEvaluatedNeighbors:
          type: number
        fitness:
          type: number
        evaluationFunctionResultsRecords:
          type: array
          items:
            type: number
        seconds:
          type: number
    BppAlgorithmDto:
      description: 'Algorithm to solve the instance'
      type: object
      properties:
        greedyAlgorithmType:
          $ref: '#/components/schemas/GreedyAlgorithmTypeDto'
        localSearchAlgorithm:
          $ref: '#/components/schemas/LocalSearchAlgorithmDto'
    LocalSearchAlgorithmDto:
      description: 'Results for each test up to the total test size'
      type: object
      required:
        - bppNeighborhoodStructures
        - bppStrategyControl
        - bppEvaluationFunction
        - bppStopCriteria
      properties:
        bppNeighborhoodStructures:
          type: array
          items:
            $ref: '#/components/schemas/BppNeighborhoodStructureDto'
        bppStrategyControl:
          $ref: '#/components/schemas/BppStrategyControlDto'
        bppEvaluationFunction:
          $ref: '#/components/schemas/BppEvaluationFunctionDto'
        bppStopCriteria:
          $ref: '#/components/schemas/BppStoppingCriteriaDto'
    BppNeighborhoodStructureDto:
      description: 'Operation applied to a instance so we can generate neighbors'
      type: object
      required:
        - bppNeighborhoodStructureOperations
      properties:
        bppNeighborhoodStructureOperations:
          type: array
          items:
            anyOf:
              - $ref: '#/components/schemas/BppBinsDestructionOperationDto'
              - $ref: '#/components/schemas/BppReconstructionOperationDto'
              - $ref: '#/components/schemas/BppStoredItemsAndFreeItemsInterchangeOperationDto'
              - $ref: '#/components/schemas/BppStoredItemsInterchangeOperationDto'
    BppNeighborhoodStructureOperationDto:
      description: 'Operation applied to a instance so we can generate neighbors'
      type: object
      required:
        - type
      properties:
        type:
          $ref: '#/components/schemas/BppNeighborhoodStructureOperationTypeDto'
    BppBinsDestructionOperationDto:
      description: 'Results for each test up to the total test size'
      allOf:
        - $ref: '#/components/schemas/BppNeighborhoodStructureOperationDto'
        - type: object
          properties:
            numberToDestroy:
              type: number
              minimum: 1
            binsSelectionFunction:
              $ref: '#/components/schemas/BppBinsSelectionFunctionDto'
    BppReconstructionOperationDto:
      allOf:
        - $ref: '#/components/schemas/BppNeighborhoodStructureOperationDto'
        - type: object
          properties:
            algorithm:
              $ref: '#/components/schemas/GreedyAlgorithmTypeDto'
    BppStoredItemsAndFreeItemsInterchangeOperationDto:
      allOf:
        - $ref: '#/components/schemas/BppNeighborhoodStructureOperationDto'
        - type: object
          properties:
            numberItemsToInterchangeFrom:
              type: number
              minimum: 1
            numberItemsToInterchangeTo:
              type: number
              minimum: 1
            numberInterchanges:
              type: number
              minimum: 1
            itemsFromSelectionFunction:
              $ref: '#/components/schemas/BppItemsSelectionFunctionDto'
            itemsInterchangeFunction:
              $ref: '#/components/schemas/BppItemsInterchangeFunctionDto'
    BppStoredItemsInterchangeOperationDto:
      allOf:
        - $ref: '#/components/schemas/BppNeighborhoodStructureOperationDto'
        - type: object
          properties:
            numberItemsToInterchangeFrom:
              type: number
              minimum: 1
            numberItemsToInterchangeTo:
              type: number
              minimum: 1
            itemsInterchangeFunction:
              $ref: '#/components/schemas/BppItemsInterchangeFunctionDto'
    BppStoppingCriteriaDto:
      description: 'Indicates the conditions needed for the local search algorithm to stop'
      type: object
      required:
        - maxNumberIterations
      properties:
        maxNumberIterations:
          type: number
          minimum: 1
    BppNeighborhoodStructureOperationTypeDto:
      type: string
      enum:
        - BINS_DESTRUCTION
        - RECONSTRUCTION
        - BINS_INTERCHANGE
        - STORED_ITEMS_AND_FREE_ITEMS_INTERCHANGE
        - STORED_ITEMS_INTERCHANGE
    BppBinsSelectionFunctionDto:
      type: string
      enum:
        - SMALLEST_OCCUPIED_CAPACITY
        - BIGGEST_MAXIMUM_LATENESS
    BppItemsSelectionFunctionDto:
      type: string
      enum:
        - BIGGEST_SIZE
    BppItemsInterchangeFunctionDto:
      type: string
      enum:
        - SIZE
        - ALWAYS
    BppStrategyControlDto:
      type: string
      enum:
        - HILL_CLIMBING
    BppEvaluationFunctionDto:
      type: string
      enum:
        - BINS_NUMBER
        - TARDINESS
        - LATENESS
        - MAXIMUM_LATENESS
        - AVAILABLE_CAPACITY
        - FITNESS
    GreedyAlgorithmTypeDto:
      type: string
      enum:
        - RANDOM
        - FIRST_FIT_DECREASING
        - BEST_FIT_DECREASING